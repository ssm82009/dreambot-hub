
# تعليمات نشر موقع تأويل على سيرفر أباتشي

## متطلبات النشر

- سيرفر أباتشي (Apache) مُثبت ومُعد
- وحدة mod_rewrite مُفعلة في أباتشي
- وحدة mod_headers مُفعلة في أباتشي (مهم لأنواع MIME)
- وحدة mod_mime مُفعلة في أباتشي (مهم لأنواع MIME)
- Node.js و npm مثبتان على جهازك المحلي أو السيرفر لبناء المشروع

## خطوات النشر

### 1. بناء المشروع للإنتاج

```bash
# تثبيت الاعتمادات
npm install

# بناء التطبيق للإنتاج
npm run build
```

بعد الانتهاء من هذه العملية، سيتم إنشاء مجلد `dist` يحتوي على الملفات اللازمة للنشر.

### 2. رفع الملفات إلى السيرفر

قم برفع جميع محتويات مجلد `dist` إلى المجلد المخصص للويب في سيرفر أباتشي (غالباً `/var/www/html` أو المجلد المحدد لدومينك).

### 3. التأكد من تفعيل الوحدات المطلوبة في أباتشي

تأكد من أن الوحدات الضرورية مفعلة في سيرفر أباتشي:

```bash
# تفعيل الوحدات المطلوبة
sudo a2enmod rewrite
sudo a2enmod headers
sudo a2enmod mime
sudo a2enmod expires
sudo a2enmod deflate

# إعادة تشغيل أباتشي
sudo systemctl restart apache2
```

### 4. تكوين ملف .htaccess

تم تضمين ملف `.htaccess` في مجلد `public` ضمن المشروع. تأكد من أنه تم نقله إلى المجلد الجذر لموقعك على السيرفر.

### 5. تكوين الاتصال بقاعدة البيانات MySQL

تأكد من أن قاعدة البيانات MySQL متاحة وأن معلومات الاتصال في ملف `src/integrations/mysql/client.ts` صحيحة:

```javascript
const DB_HOST = "localhost"; // تأكد من تغييره إلى عنوان قاعدة البيانات الخاصة بك
const DB_USER = "taweel_1";
const DB_PASSWORD = "TLtyrBxFn3F4Hb4y";
const DB_NAME = "taweel_1";
```

### 6. التأكد من استخدام MySQL بدلاً من Supabase

افتح ملف `src/integrations/database.ts` وتأكد من أن `USE_MYSQL` مضبوط على `true`.

### 7. إنشاء جداول قاعدة البيانات المطلوبة

قم بإنشاء جداول قاعدة البيانات الضرورية باستخدام SQL. يمكنك استخدام phpMyAdmin أو أي أداة أخرى لإدارة قاعدة البيانات MySQL.

### 8. اختبار التطبيق

بعد الانتهاء من جميع الخطوات السابقة، قم بفتح موقعك على المتصفح وتأكد من أنه يعمل بشكل صحيح.

## استكشاف الأخطاء وإصلاحها

إذا واجهتك مشاكل، تحقق مما يلي:

1. هل أذونات الملفات صحيحة؟ تأكد من أن جميع الملفات والمجلدات لها الأذونات المناسبة.
   ```bash
   sudo chown -R www-data:www-data /var/www/html
   sudo chmod -R 755 /var/www/html
   ```

2. هل تم تكوين AllowOverride بشكل صحيح؟ افتح ملف تكوين الموقع في أباتشي وتأكد من وجود:
   ```
   <Directory /var/www/html>
       AllowOverride All
   </Directory>
   ```

3. هل هناك أخطاء في سجلات أباتشي؟ تحقق من سجلات الخطأ:
   ```bash
   tail -f /var/log/apache2/error.log
   ```

4. إصلاح مشكلات MIME:
   - تأكد من أن أباتشي يقدم ملفات JavaScript مع نوع MIME الصحيح
   - إذا استمرت المشكلة، يمكنك إضافة تكوينات إضافية إلى ملف ".htaccess" المذكور أعلاه
   - يمكنك التحقق من أنواع MIME التي يستخدمها الخادم عن طريق أدوات المطور في المتصفح
